services:
  # Frontend React App
  - type: web
    name: ctf-frontend
    runtime: static
    buildCommand: npm run build
    staticPublishPath: ./dist
    envVars:
      - key: VITE_CONVEX_URL
        fromSecret: convex-url
      - key: VITE_API_URL
        fromSecret: api-url

  # Backend FastAPI App
  - type: web
    name: ctf-backend
    runtime: python3
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: CONVEX_URL
        fromSecret: convex-url
      - key: MONGO_URL
        fromSecret: mongo-url
      - key: SECRET_KEY
        generateValue: true
      - key: JWT_SECRET_KEY
        generateValue: true

secrets:
  convex-url:
    value: "https://your-convex-deployment-url"  # Replace with your actual Convex URL
  api-url:
    value: "https://ctf-backend.onrender.com"  # This will be auto-generated by Render
  mongo-url:
    value: "your-mongodb-connection-string"  # Replace with your MongoDB URL